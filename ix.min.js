/*Copyright (c) Microsoft Open Technologies, Inc.  All rights reserved.
Microsoft Open Technologies would like to thank its contributors, a list.
of whom are at http://aspnetwebstack.codeplex.com/wikipage?title=Contributors..
Licensed under the Apache License, Version 2.0 (the "License"); you.
may not use this file except in compliance with the License. You may.
obtain a copy of the License at.

http://www.apache.org/licenses/LICENSE-2.0.

Unless required by applicable law or agreed to in writing, software.
distributed under the License is distributed on an "AS IS" BASIS,.
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or.
implied. See the License for the specific language governing permissions.
and limitations under the License..
*/
(function(e,t){var n=typeof exports=="object"&&exports&&(typeof e=="object"&&e&&e==e.global&&(window=e),exports);typeof define=="function"&&define.amd?define(["Ix","exports"],function(n,r){return e.Ix=t(e,r,n),e.Ix}):typeof module=="object"&&module&&module.exports==n?module.exports=t(e,module.exports,require("./l2o")):e.Ix=t(e,{},e.Ix)})(this,function(e,t,n,r){function i(){}function s(e){return e}function o(e,t){return e>t?1:e<t?-1:0}function u(e,t){return e===t}function a(e,t){t||(t=u);for(var n=0,r=this.length;n<r;n++)if(t(e,this[n]))return n;return-1}function y(e,t,n){var r=[],i=e.getEnumerator();try{if(!i.moveNext())throw new Error(f);var s=i.getCurrent(),o=t(s);r.push(s);while(i.moveNext()){var u=i.getCurrent(),a=t(u),l=n(a,o);l===0?r.push(u):l>0&&(r=[u],o=a)}}finally{i.dispose()}return v(r)}function w(e){this.readerCount=e,this.list={},this.length=0}function x(){this.list=[],this.length=0}function k(e,t){return function(){e.apply(t,arguments)}}function L(e,t){var n=this;return new c(function(){var r,i,s=e;return g(function(){i||(i=n.getEnumerator());if(!i.moveNext())return!1;var e=i.getCurrent();return s=t(s,e),r=s,!0},function(){return r},function(){i&&i.dispose()})})}function A(e){var t=this;return new c(function(){var n,r,i,s=!1;return g(function(){r||(r=t.getEnumerator());for(;;){if(!r.moveNext())return!1;var o=r.getCurrent();if(!s){s=!0,i=o;continue}return i=e(i,o),n=i,!0}},function(){return n},function(){r&&r.dispose()})})}function O(e,t){return new c(function(){var n,r,i;return g(function(){o||(o=e.getEnumerator());for(;;){var r,s;try{r=o.moveNext(),s=o.getCurrent()}catch(o){i=t(o);break}if(!r)break;return n=s,!0}if(i)return i.moveNext()?(n=i.getCurrent(),!0):!1},function(){return n},function(){r.dispose(),i&&i.dispose()})})}var f="Sequence contains no elements.",l=Array.prototype.slice,c=n.Enumerable,h=c.prototype,p=c.concat,d=c.empty,v=c.fromArray,m=c.repeat,g=n.Enumerator.create;inherits=n.internals.inherits,h.isEmpty=function(){return!this.any()},h.min=function(e){return this.minBy(s,e).first()},h.minBy=function(e,t){return t||(t=o),y(this,e,function(e,n){return-t(e,n)})},h.max=function(e){if(e)return this.select(e).max();var t,n=!1,r=this.getEnumerator();try{while(r.moveNext()){var i=r.getCurrent();n?i>t&&(t=i):(t=i,n=!0)}}finally{r.dispose()}if(!n)throw new Error(f);return t},h.maxBy=function(e,t){return t||(t=o),y(this,e,t)};var b=function(){function e(e){this.disposed=!1,this.source=e}return inherits(e,c),e.prototype.getEnumerator=function(){if(this.disposed)throw new Error("Object disposed");var e,t=this;return g(function(){return t.source.moveNext()?(e=t.source.getCurrent(),!0):!1},function(){return e})},e.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.source.dispose(),this.source=null)},e}();h.share=function(e){var t=this;return e?new c(function(){return e(t.share()).getEnumerator()}):new b(t.getEnumerator())};var E=w.prototype;E.clear=function(){this.list={},this.length=0},E.get=function(e){if(!this.list[e])throw new Error("Element no longer available in the buffer.");var t=this.list[e];return--t.length===0&&delete this.list[e],t.value},E.push=function(e){this.list[this.length++]={value:e,length:this.readerCount},this.length++},E.done=function(){this.readerCount--};var S=function(){function e(e){this.source=e,this.buffer=new w(0),this.disposed=!1,this.stopped=!1,this.error=null}function t(e){var t,n,r=this,i=!1,s=!0;return g(function(){u||(u=r.source.getEnumerator());if(r.disposed)throw new Error("Object disposed");s||e++;var n=!1,o;if(e<=r.buffer.length){if(!r.stopped)try{hasNext=r.source.moveNext(),hasValue&&(o=r.source.getCurrent())}catch(u){r.stopped=!0,r.error=u,r.source.dispose(),i=!0}if(r.stopped){if(r.error)throw r.error;return!1}hasValue&&r.buffer.push(o)}else hasValue=!0;return hasValue?(t=r.buffer[e],s=!1,!0):!1},function(){return t},function(){r.buffer&&r.buffer.done(e),n&&i&&n.dispose()})}return inherits(e,c),e.prototype.getEnumerator=function(){var e=this.buffer.length;return this.buffer.length++,t.call(this,e)},e.prototype.dispose=function(){this.disposed||(this.source.dispose(),this.source=null,this.buffer.clear(),this.buffer=null,this.disposed=!0)},e}();h.publish=function(e){var t=this;return e?new c(function(){return e(t.publish()).getEnumerator()}):new S(t.getEnumerator())};var T=x.prototype;T.done=i,T.push=function(e){this.list[this.length++]=e},T.clear=function(){this.list=[],this.length=0},T.get=function(e){return this.list[e]};var N=function(){function e(e,t){this.source=e,this.buffer=t,this.stopped=!1,this.error=null,this.disposed=!1}inherits(e,c),e.prototype.getEnumerator=function(){var e,t,n=this,r=!1,i=!0,s=0;return g(function(){u||(u=n.source.getEnumerator());if(n.disposed)throw new Error("Object disposed");i||s++;var t=!1,o;if(s<=n.buffer.length){if(!n.stopped)try{hasNext=n.source.moveNext(),hasValue&&(o=n.source.getCurrent())}catch(u){n.stopped=!0,n.error=u,n.source.dispose(),r=!0}if(n.stopped){if(n.error)throw n.error;return!1}hasValue&&n.buffer.push(o)}else hasValue=!0;return hasValue?(e=n.buffer[s],i=!1,!0):!1},function(){return e},function(){n.buffer&&n.buffer.done(s),t&&r&&t.dispose()})},e.prototype.dispose=function(){this.disposed||(this.source.dispose(),this.source=null,this.buffer.clear(),this.buffer=null,this.disposed=!0)}}();h.memoize=function(){var e=this;return arguments.length===0?new N(e.getEnumerator(),new x):arguments.length===1&&typeof arguments[1]=="function"?new c(function(){return arguments[1](e.memoize()).getEnumerator()}):arguments.length===1&&typeof arguments[1]=="number"?new N(e.getEnumerator(),new w(arguments[1])):new c(function(){return arguments[2](e.memoize(arguments[1])).getEnumerator()})},c.returnValue=function(e){return new c(function(){var t=!1;return g(function(){return t?!1:t=!0},function(){return e})})},c.throwException=function(e){return new c(function(){return g(function(){throw e},i)})};var C=c.defer=function(e){return new c(function(){var t;return g(function(){return t||(t=e().getEnumerator()),t.moveNext()},function(){return t.getCurrent()},function(){t.dispose()})})};c.generate=function(e,t,n,r){return new c(function(){var i,s,o=!1;return g(function(){if(!o)i=e,o=!0;else{i=n(i);if(!t(i))return!1}return s=r(i),!0},function(){return s})})},c.using=function(e,t){return new c(function(){var n,r=!0,i,s;return g(function(){return r&&(s=e(),i=t(s).getEnumerator(),r=!1),i.moveNext()?(n=i.getCurrent(),!0):!1},function(){return n},function(){i&&i.dispose(),s&&s.dispose()})})},h.doAction=function(e,t,n){var r,s,o,u=this;return typeof e=="object"?(r=k(e.onNext,e),s=k(e.onError,e),o=k(e.onCompleted,e)):(r=e,s=t||i,o=n||i),new c(function(){var e,t,n;return g(function(){e||(e=u.getEnumerator());try{if(!e.moveNext())return o(),!1;n=e.getCurrent()}catch(e){throw s(e),e}return r(n),!0},function(){return n},function(){e&&e.dispose()})})},h.bufferWithCount=function(e,t){var n=this;return t==null&&(t=e),new c(function(){var r=[],i=0,s,o;return g(function(){s||(s=n.getEnumerator());for(;;){if(!s.moveNext())return r.length>0?(o=c.fromArray(r.shift()),!0):!1;i%t===0&&r.push([]);for(var u=0,a=r.length;u<a;u++)r[u].push(s.getCurrent());if(r.length>0&&r[0].length===e)return o=c.fromArray(r.shift()),++i,!0;++i}},function(){return o},function(){s.dispose()})})},h.ignoreElements=function(){var e=this;return new c(function(){var t;return g(function(){t=e.getEnumerator();while(t.moveNext());return!1},function(){throw new Error("Operation is not valid due to the current state of the object.")},function(){t.dispose()})})},h.distinctBy=function(e,t){t||(t=u);var n=this;return new c(function(){var r,i=[],s;return g(function(){s||(s=n.getEnumerator());for(;;){if(!s.moveNext())return!1;var o=s.getCurrent(),u=e(o);if(a.call(i,u,t)===-1)return i.push(o),r=o,!0}},function(){return r},function(){s&&s.dispose()})})},h.distinctUntilChanged=function(e,t){e||(e=s),t||(t=u);var n=this;return new c(function(){var r,i,s,o;return g(function(){i||(i=n.getEnumerator());for(;;){if(!i.moveNext())return!1;var u=i.getCurrent(),a=e(u),f=!1;o&&(f=t(s,a));if(!o||!f)return r=u,s=a,o=!0,!0}},function(){return r},function(){i&&i.dispose()})})},h.expand=function(e){var t=this;return new c(function(){var n,r=[t],i;return g(function(){for(;;){if(!i){if(r.length===0)return!1;i=r.shift().getEnumerator()}if(i.moveNext())return n=i.getCurrent(),r.push(e(n)),!0;i.dispose(),i=null}},function(){return n},function(){i&&i.dispose()})})},h.startWith=function(){return p(v(l.call(arguments)),this)},h.scan=function(){var e=arguments.length===1?A:L;return e.apply(this,arguments)},h.takeLast=function(e){var t=this;return new c(function(){var n,r,i;return g(function(){r||(r=t.getEnumerator());if(!i){i=[];while(r.moveNext())i.push(r.getCurrent()),i.length>e&&i.shift()}return i.length===0?!1:(n=i.shift(),!0)},function(){return n},function(){r&&r.dispose()})})},h.skipLast=function(e){var t=this;return new c(function(){var n,r,i=[];return g(function(){r||(r=t.getEnumerator());for(;;){if(!r.moveNext())return!1;i.push(r.getCurrent());if(i.length>e)return n=i.shift(),!0}},function(){return n},function(){r&&r.dispose()})})},h.repeat=function(e){var t=this;return m(0,e).selectMany(function(){return t})},h.catchException=function(e){return e==="function"?O(this,e):enumerableCatch(this,e)},c.catchException=function(){var e=arguments;return new c(function(){var t=0,n,r,i;return g(function(){if(t<e.length){o||(o=e[t++].getEnumerator());for(;;){var r,s;try{r=o.moveNext(),s=o.getCurrent()}catch(o){i=o;break}if(!r){o.dipose(),o=null;break}return n=s,!0}if(!i)return!1}if(i)throw i;return!1},function(){return n},function(){r.dispose()})})},h.finallyDo=function(e){var t=this;return new c(function(){var n=t.getEnumerator();return g(function(){return n.moveNext()},function(){return n.getCurrent()},function(){n.dispose(),e()})})},h.onErrorResumeNext=function(e){return M.apply(null,[this,e])};var M=c.onErrorResumeNext=function(){var e=arguments;return new c(function(){var t,n=0,r;return g(function(){while(n<e.length){r||(r=e[n++].getEnumerator());try{var i=r.moveNext();if(i)return t=r.getCurrent(),!0}catch(s){}r.dispose(),r=null}return!1},function(){return t},function(){r&&r.dispose()})})};h.retry=function(e){var t=this;return new c(function(){var n,r,i=e;return i==null&&(i=-1),g(function(){e||(e=t.getEnumerator());for(;;)try{return e.moveNext()?(n=e.getCurrent(),!0):!1}catch(e){if(i--===0)throw e}},function(){return n},function(){r.dispose()})})};var _=c.whileDo=function(e,t){return m(t).takeWhile(e).selectMany(s)};return c.ifThen=function(e,t,n){return n||(n=d()),C(function(){return e()?t:n})},c.doWhile=function(e,t){return e.concat(_(t,e))},c.cases=function(e,t,n){return n||(n=d()),C(function(){var r=t[e()];return r||(r=n),r})},c.forIn=function(e,t){return e.select(t)},n});